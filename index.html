<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Intelligence OS v17.0</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        body { background: #010409; color: white; font-family: 'Inter', sans-serif; overflow: hidden; margin: 0; }
        .glass { background: rgba(13, 17, 23, 0.95); backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .app-card { transition: 0.2s; cursor: pointer; border-radius: 1.5rem; height: 110px; border: 1px solid transparent; }
        .app-card:hover { border-color: #6366f1; background: rgba(30, 41, 59, 0.5); }
        .app-card:active { transform: scale(0.95); }
        canvas { touch-action: none; background: #000; border-radius: 1rem; border: 1px solid #333; }
        .snake-dot { width: 10px; height: 10px; position: absolute; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect, useRef, memo } = React;

        // --- MODULE: AI NEURAL ENGINE ---
        const AICore = ({ role, apiKey }) => {
            const [history, setHistory] = useState([{ role: 'assistant', content: `Identity: ${role}. Ready for commands.` }]);
            const [input, setInput] = useState('');
            const [loading, setLoading] = useState(false);
            const ask = async () => {
                if(!apiKey) return alert("Enter Groq Key in Settings!");
                const next = [...history, { role: 'user', content: input }];
                setHistory(next); setInput(''); setLoading(true);
                try {
                    const res = await fetch("https://api.groq.com/openai/v1/chat/completions", {
                        method: "POST",
                        headers: { "Authorization": `Bearer ${apiKey}`, "Content-Type": "application/json" },
                        body: JSON.stringify({ model: "llama-3.3-70b-versatile", messages: next })
                    });
                    const data = await res.json();
                    setHistory([...next, data.choices[0].message]);
                } catch (e) { alert("AI Bridge Offline"); }
                setLoading(false);
            };
            return (
                <div className="w-full max-w-lg h-[450px] flex flex-col glass rounded-3xl p-4">
                    <div className="flex-1 overflow-y-auto space-y-4 mb-4 pr-2">
                        {history.map((m, i) => <div key={i} className={`flex ${m.role==='user'?'justify-end':'justify-start'}`}><div className={`p-3 rounded-2xl max-w-[85%] text-sm ${m.role==='user'?'bg-indigo-600':'bg-white/10'}`}>{m.content}</div></div>)}
                        {loading && <div className="text-indigo-400 animate-pulse text-[10px] font-black uppercase">Processing...</div>}
                    </div>
                    <div className="flex gap-2 bg-black/40 p-2 rounded-2xl">
                        <input value={input} onChange={e=>setInput(e.target.value)} onKeyDown={e=>e.key==='Enter'&&ask()} className="flex-1 bg-transparent px-2 outline-none" placeholder="Talk to Intelligence..." />
                        <button onClick={ask} className="bg-indigo-600 px-4 py-2 rounded-xl text-xs font-bold">EXEC</button>
                    </div>
                </div>
            );
        };

        // --- MODULE: SNAKE GAME ---
        const Snake = () => {
            const [pos, setPos] = useState([{x:10, y:10}]);
            const [food, setFood] = useState({x:5, y:5});
            const [dir, setDir] = useState({x:0, y:-1});
            useEffect(() => {
                const move = setInterval(() => {
                    setPos(prev => {
                        const head = {x: prev[0].x + dir.x, y: prev[0].y + dir.y};
                        if(head.x < 0 || head.x >= 20 || head.y < 0 || head.y >= 20) return [{x:10, y:10}];
                        const next = [head, ...prev.slice(0, -1)];
                        if(head.x === food.x && head.y === food.y) {
                            setFood({x: Math.floor(Math.random()*20), y: Math.floor(Math.random()*20)});
                            return [head, ...prev];
                        }
                        return next;
                    });
                }, 150);
                return () => clearInterval(move);
            }, [dir, food]);
            return (
                <div className="flex flex-col items-center">
                    <div className="relative w-64 h-64 bg-black border border-white/10">
                        {pos.map((p, i) => <div key={i} className="absolute bg-indigo-500 rounded-sm" style={{left: p.x*12.8, top: p.y*12.8, width: 12, height: 12}} />)}
                        <div className="absolute bg-red-500 rounded-full" style={{left: food.x*12.8, top: food.y*12.8, width: 12, height: 12}} />
                    </div>
                    <div className="grid grid-cols-3 gap-2 mt-4">
                        <div /><button onClick={()=>setDir({x:0, y:-1})} className="p-3 glass rounded-xl">‚Üë</button><div />
                        <button onClick={()=>setDir({x:-1, y:0})} className="p-3 glass rounded-xl">‚Üê</button>
                        <button onClick={()=>setDir({x:0, y:1})} className="p-3 glass rounded-xl">‚Üì</button>
                        <button onClick={()=>setDir({x:1, y:0})} className="p-3 glass rounded-xl">‚Üí</button>
                    </div>
                </div>
            );
        };

        // --- MODULE: SKETCH PAD ---
        const Sketch = () => {
            const canvasRef = useRef(null);
            const [draw, setDraw] = useState(false);
            useEffect(() => {
                const c = canvasRef.current;
                c.width = c.parentElement.offsetWidth; c.height = 350;
                const ctx = c.getContext('2d'); ctx.lineCap = 'round'; ctx.strokeStyle = '#6366f1'; ctx.lineWidth = 4;
            }, []);
            const drawStroke = (e) => {
                if(!draw) return;
                const rect = canvasRef.current.getBoundingClientRect();
                const x = (e.clientX || e.touches[0].clientX) - rect.left;
                const y = (e.clientY || e.touches[0].clientY) - rect.top;
                const ctx = canvasRef.current.getContext('2d');
                ctx.lineTo(x, y); ctx.stroke(); ctx.beginPath(); ctx.moveTo(x, y);
            };
            return (
                <div className="w-full max-w-lg">
                    <button onClick={() => canvasRef.current.getContext('2d').clearRect(0,0,1000,1000)} className="mb-2 text-[10px] font-bold text-red-500 uppercase">Clear All</button>
                    <canvas ref={canvasRef} onMouseDown={()=>setDrawing(true)} onMouseMove={drawStroke} onMouseUp={()=>{setDraw(false); canvasRef.current.getContext('2d').beginPath()}} onTouchStart={()=>setDraw(true)} onTouchMove={drawStroke} onTouchEnd={()=>{setDraw(false); canvasRef.current.getContext('2d').beginPath()}} />
                </div>
            );
        };

        // --- SYSTEM CORE ---
        const App = () => {
            const [active, setActive] = useState(null);
            const [apiKey, setApiKey] = useState(localStorage.getItem('groq_key') || '');
            const [assetIdx, setAssetIdx] = useState(0);
            const [prices, setPrices] = useState({ 0: Array(20).fill(65000), 1: Array(20).fill(2300), 2: Array(20).fill(83.5), 3: Array(20).fill(1.0) });
            const assets = [{n:"Bitcoin", s:"‚Çø", b:65000, c:"#F7931A"}, {n:"Gold", s:"AU", b:2300, c:"#FFD700"}, {n:"Rupee", s:"‚Çπ", b:83.5, c:"#16a34a"}, {n:"Dollar", s:"$", b:1.0, c:"#3b82f6"}];

            useEffect(() => {
                const i = setInterval(() => {
                    setPrices(prev => {
                        const n = {...prev};
                        [0,1,2,3].forEach(idx => {
                            const last = n[idx][19];
                            n[idx] = [...n[idx].slice(1), last + (Math.random()-0.49) * (assets[idx].b * 0.02)];
                        });
                        return n;
                    });
                }, 2000);
                return () => clearInterval(i);
            }, []);

            const cur = prices[assetIdx];
            const apps = [
                { id: 'ai', name: 'Neural Chat', i: 'üß†', comp: <AICore role="General Assistant" apiKey={apiKey} /> },
                { id: 'med', name: 'Medical AI', i: 'ü©∫', comp: <AICore role="Medical Specialist" apiKey={apiKey} /> },
                { id: 'snake', name: 'Retro Snake', i: 'üêç', comp: <Snake /> },
                { id: 'sketch', name: 'Sketch Pro', i: 'üé®', comp: <Sketch /> },
                { id: 'settings', name: 'Settings', i: '‚öôÔ∏è', comp: (
                    <div className="glass p-8 rounded-3xl w-full max-w-sm">
                        <h3 className="text-xs font-black uppercase mb-4 opacity-50">API Authentication</h3>
                        <input type="password" value={apiKey} onChange={e=>{setApiKey(e.target.value); localStorage.setItem('groq_key', e.target.value)}} className="w-full bg-black/50 p-4 rounded-xl border border-white/10 outline-none focus:border-indigo-500" placeholder="Paste Groq Key..." />
                    </div>
                )}
            ];

            return (
                <div className="h-screen w-screen flex flex-col p-4 md:p-10 overflow-hidden">
                    {active ? (
                        <div className="fixed inset-0 z-50 glass flex flex-col p-6 overflow-y-auto">
                            <div className="flex justify-between items-center mb-10">
                                <button onClick={() => setActive(null)} className="text-[10px] font-black uppercase tracking-widest bg-white/10 px-4 py-2 rounded-full">‚Üê System Home</button>
                                <h2 className="text-xl font-black uppercase italic text-indigo-400">{active.name}</h2>
                                <div className="w-10"></div>
                            </div>
                            <div className="flex-1 flex justify-center items-center">{active.comp}</div>
                        </div>
                    ) : (
                        <div className="max-w-4xl mx-auto w-full">
                            <h1 className="text-center text-4xl font-black italic uppercase tracking-tighter mb-10">Intelligence OS <span className="text-indigo-500 text-xs tracking-widest block mt-2">v17.0 Master Build</span></h1>
                            <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                                <div onClick={() => setAssetIdx((assetIdx + 1) % 4)} className="col-span-2 glass p-6 rounded-3xl h-32 flex flex-col justify-between cursor-pointer">
                                    <div className="flex justify-between font-black uppercase text-sm">
                                        <span style={{color: assets[assetIdx].c}}>{assets[assetIdx].s} {assets[assetIdx].n}</span>
                                        <span className={cur[19] > cur[18] ? 'text-green-400' : 'text-red-400'}>{cur[19].toFixed(2)}</span>
                                    </div>
                                    <svg className="h-10 w-full" preserveAspectRatio="none" viewBox="0 0 100 20">
                                        <polyline fill="none" stroke={cur[19] > cur[18] ? '#22c55e' : '#ef4444'} strokeWidth="3" points={cur.map((p, i) => `${(i / 19) * 100},${20 - ((p / (assets[assetIdx].b * 1.5)) * 20)}`).join(' ')} />
                                    </svg>
                                </div>
                                {apps.map(a => (
                                    <div key={a.id} onClick={() => setActive(a)} className="glass app-card">
                                        <span className="text-3xl mb-2">{a.i}</span>
                                        <p className="text-[9px] font-black uppercase tracking-widest opacity-50">{a.name}</p>
                                    </div>
                                ))}
                            </div>
                        </div>
                    )}
                </div>
            );
        };
        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
