<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Intelligence OS v3.0</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        body { background: #010409; color: white; font-family: 'Inter', sans-serif; overflow: hidden; }
        .glass { background: rgba(13, 17, 23, 0.8); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .app-card { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); cursor: pointer; border-radius: 1.2rem; }
        .app-card:hover { transform: translateY(-3px); border-color: rgba(99, 102, 241, 0.5); }
        .app-card:active { transform: scale(0.95); }
        .shimmer { background: linear-gradient(90deg, transparent, rgba(255,255,255,0.05), transparent); background-size: 200% 100%; animation: shimmer 2s infinite; }
        @keyframes shimmer { 0% { background-position: -200% 0; } 100% { background-position: 200% 0; } }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const App = () => {
            const [activeApp, setActiveApp] = useState(null);
            const [input, setInput] = useState("");
            const [chat, setChat] = useState([]);
            const [assetIndex, setAssetIndex] = useState(0);
            const [priceData, setPriceData] = useState({ price: 0, trend: 'up', history: [] });
            const [gameScore, setGameScore] = useState(0);

            const assets = [
                { name: "Bitcoin", symbol: "‚Çø", color: "#F7931A", base: 45000 },
                { name: "Gold", symbol: "AU", color: "#FFD700", base: 2000 },
                { name: "Silver", symbol: "AG", color: "#C0C0C0", base: 25 },
                { name: "USD/INR", symbol: "‚Çπ", color: "#16a34a", base: 83.2 }
            ];

            // 1. Fixed Stock Pulse (Small, Clear Arrows)
            useEffect(() => {
                const interval = setInterval(() => {
                    setPriceData(prev => {
                        const base = assets[assetIndex].base;
                        const change = (Math.random() - 0.48) * (base * 0.01);
                        const newPrice = Math.max(0, (parseFloat(prev.price) || base) + change);
                        return {
                            price: newPrice.toFixed(2),
                            trend: change >= 0 ? 'up' : 'down',
                            history: [...prev.history, newPrice].slice(-20)
                        };
                    });
                }, 2000);
                return () => clearInterval(interval);
            }, [assetIndex]);

            // 2. Anti-Crash Trigger
            useEffect(() => {
                if (input === "10+9=21" || input === "67") {
                    if (window.navigator.vibrate) window.navigator.vibrate(200);
                    setInput("EASTER EGG!");
                }
            }, [input]);

            const apps = [
                { id: 'ai', name: 'Neural Chat', i: 'üß†', prompt: "General Assistant" },
                { id: 'med', name: 'Med-AI', i: 'ü©∫', prompt: "Medical Expert" },
                { id: 'gym', name: 'Coach', i: 'üèãÔ∏è', prompt: "Gym Coach" },
                { id: 'chef', name: 'Chef Mode', i: 'üë®‚Äçüç≥', prompt: "Master Chef" },
                { id: 'stock', name: 'Pulse', i: 'üìà' },
                { id: 'term', name: 'Terminal', i: 'üêö', prompt: "Linux Terminal" },
                { id: 'snake', name: 'Snake', i: 'üêç', type: 'game' },
                { id: 'mole', name: 'Whack', i: 'üî®', type: 'game' },
                { id: 'match', name: 'Memory', i: 'üß©', type: 'game' },
                { id: 'ttt', name: 'Tic-Tac', i: '‚ùå', type: 'game' },
                { id: 'math', name: 'Calc', i: 'üî¢' },
                { id: 'sketch', name: 'Sketch', i: 'üé®' }
            ];

            const handleChat = async () => {
                if (!input) return;
                const newChat = [...chat, { role: 'user', content: input }];
                setChat(newChat);
                setInput("");
                setChat([...newChat, { role: 'assistant', content: "AI Connection established. (Add Groq API Key to chat)..." }]);
            };

            // --- MINI GAME COMPONENTS ---
            const SnakeGame = () => {
                return (
                    <div className="flex flex-col items-center">
                        <div className="grid grid-cols-10 gap-1 bg-black/40 p-2 rounded-lg">
                            {[...Array(100)].map((_, i) => (
                                <div key={i} className={`w-6 h-6 rounded-sm ${i === 45 ? 'bg-green-500' : i === 47 ? 'bg-red-500' : 'bg-white/5'}`}></div>
                            ))}
                        </div>
                        <p className="mt-4 text-xs text-gray-400 font-mono">Mobile Snake Engine v1.0</p>
                    </div>
                );
            };

            const MemoryMatch = () => {
                const icons = ['üî•', 'üíé', 'üçÄ', 'üöÄ', 'üî•', 'üíé', 'üçÄ', 'üöÄ'];
                return (
                    <div className="grid grid-cols-4 gap-2">
                        {icons.map((icon, i) => (
                            <button key={i} onClick={() => setGameScore(s => s + 1)} className="w-16 h-16 glass rounded-xl text-2xl active:bg-indigo-600 transition">?</button>
                        ))}
                    </div>
                );
            };

            const WhackAMole = () => {
                return (
                    <div className="grid grid-cols-3 gap-4">
                        {[...Array(9)].map((_, i) => (
                            <div key={i} onClick={() => setGameScore(s => s + 1)} className="w-20 h-20 rounded-full bg-orange-900/30 border-b-4 border-black flex items-center justify-center active:scale-95 transition cursor-pointer">
                                {Math.random() > 0.8 ? 'üêπ' : ''}
                            </div>
                        ))}
                    </div>
                );
            };

            return (
                <div className="h-screen w-full flex flex-col p-4">
                    {activeApp ? (
                        <div className="flex-1 flex flex-col glass rounded-3xl overflow-hidden">
                            <div className="p-4 border-b border-white/10 flex justify-between items-center">
                                <button onClick={() => {setActiveApp(null); setChat([]); setGameScore(0)}} className="text-xs font-bold uppercase tracking-widest text-indigo-400">‚Üê Back</button>
                                <span className="font-bold text-sm uppercase">{activeApp.name} {activeApp.type === 'game' && `| Score: ${gameScore}`}</span>
                                <div className="w-8"></div>
                            </div>
                            
                            <div className="flex-1 flex items-center justify-center p-4">
                                {activeApp.id === 'snake' && <SnakeGame />}
                                {activeApp.id === 'match' && <MemoryMatch />}
                                {activeApp.id === 'mole' && <WhackAMole />}
                                {activeApp.id === 'ttt' && (
                                    <div className="grid grid-cols-3 gap-2">
                                        {[...Array(9)].map((_, i) => <button key={i} className="w-20 h-20 glass text-2xl font-bold rounded-xl">/</button>)}
                                    </div>
                                )}
                                {(!activeApp.type) && (
                                    <div className="w-full h-full flex flex-col">
                                        <div className="flex-1 overflow-y-auto space-y-2">
                                            {chat.map((m, i) => <div key={i} className={`p-3 rounded-xl max-w-[80%] ${m.role === 'user' ? 'ml-auto bg-indigo-600' : 'bg-white/10'}`}>{m.content}</div>)}
                                        </div>
                                        <div className="mt-4 flex gap-2">
                                            <input value={input} onChange={e => setInput(e.target.value)} className="flex-1 bg-white/5 p-3 rounded-xl outline-none" placeholder="Enter command..."/>
                                            <button onClick={handleChat} className="bg-indigo-600 px-4 rounded-xl">SEND</button>
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>
                    ) : (
                        <div className="max-w-4xl mx-auto w-full">
                            <div className="text-center mb-6">
                                <h1 className="text-3xl font-black italic tracking-tighter uppercase">Intelligence OS</h1>
                                <p className="text-[10px] text-gray-500 tracking-[0.4em]">12-IN-1 QUANTUM SUITE</p>
                            </div>

                            <div className="grid grid-cols-2 md:grid-cols-4 gap-3">
                                {/* Fixed Stock Pulse Card */}
                                <div onClick={() => setAssetIndex((assetIndex + 1) % assets.length)} className="col-span-2 glass p-4 rounded-[1.5rem] app-card flex flex-col justify-between min-h-[120px]">
                                    <div className="flex justify-between items-start">
                                        <span className="text-[10px] font-bold text-indigo-500 uppercase tracking-widest">{assets[assetIndex].name}</span>
                                        <div className={`flex items-center gap-1 text-xs font-bold ${priceData.trend === 'up' ? 'text-green-500' : 'text-red-500'}`}>
                                            {priceData.trend === 'up' ? '‚ñ≤' : '‚ñº'} {assets[assetIndex].symbol}{priceData.price}
                                        </div>
                                    </div>
                                    <div className="h-10 w-full">
                                        <svg className="w-full h-full" preserveAspectRatio="none" viewBox="0 0 100 20">
                                            <polyline fill="none" stroke={priceData.trend === 'up' ? '#22c55e' : '#ef4444'} strokeWidth="2"
                                                points={priceData.history.map((p, i) => `${(i / 19) * 100},${20 - ((p / (assets[assetIndex].base * 1.5)) * 20)}`).join(' ')} />
                                        </svg>
                                    </div>
                                </div>

                                {apps.filter(a => a.id !== 'stock').map(app => (
                                    <div key={app.id} onClick={() => setActiveApp(app)} className="glass p-5 flex flex-col items-center justify-center app-card relative overflow-hidden group">
                                        <span className="text-2xl mb-2">{app.i}</span>
                                        <p className="text-[9px] font-black uppercase tracking-widest">{app.name}</p>
                                        <div className="absolute inset-0 shimmer opacity-0 group-hover:opacity-100"></div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
